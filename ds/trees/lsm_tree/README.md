# LSM-Tree (Log-Structured Merge-Tree)

## –ß—Ç–æ —Ç–∞–∫–æ–µ LSM-Tree?
LSM-Tree (Log-Structured Merge-Tree) ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏. –û–Ω–∞ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ **LevelDB, RocksDB, Cassandra**, –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∏—Å–∫–æ–º –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã LSM-Tree

### 1. **–ú–µ–º—Ç–∞–±–ª–∏—Ü–∞ (MemTable)**
- –î–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å –≤ –≤–∏–¥–µ **—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞** (–æ–±—ã—á–Ω–æ **Red-Black Tree** –∏–ª–∏ **Skip List**).
- –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –æ–±—ä—ë–º–∞ –º–µ–º—Ç–∞–±–ª–∏—Ü–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –≤ –≤–∏–¥–µ **SSTable (Sorted String Table)**.

### 2. **SSTable (Immutable Sorted Table)**
- –≠—Ç–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ –¥–∏—Å–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ **–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è**.
- SSTable —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –º–µ–º—Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –¥–∏—Å–∫.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –≤ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π (Level 0, Level 1, ...)** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏.

### 3. **–ë–ª—É–º-—Ñ–∏–ª—å—Ç—Ä—ã (Bloom Filters)**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –∫–ª—é—á–∞ –≤ SSTable –ø–µ—Ä–µ–¥ –µ—ë –∑–∞–≥—Ä—É–∑–∫–æ–π —Å –¥–∏—Å–∫–∞.
- –ü–æ–º–æ–≥–∞—é—Ç —É—Å–∫–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞, —Å–Ω–∏–∂–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–Ω—É–∂–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ —Ñ–∞–π–ª–∞–º.

### 4. **–ö–æ–º–ø–∞–∫—Ü–∏—è (Compaction)**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ SSTables –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è (—Å–ª–∏–≤–∞—é—Ç—Å—è) –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ –∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã.
- –ö–æ–º–ø–∞–∫—Ü–∏—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ä–æ—Å—Ç —á–∏—Å–ª–∞ SSTables –∏ —É–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–æ–∏—Å–∫.

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã LSM-Tree
1. **–ó–∞–ø–∏—Å—å**:
   - –î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –≤ –º–µ–º—Ç–∞–±–ª–∏—Ü—É.
   - –ö–æ–≥–¥–∞ –º–µ–º—Ç–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ª–∏–º–∏—Ç–∞, –æ–Ω–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ SSTable –Ω–∞ –¥–∏—Å–∫.
   - –ö–æ–º–ø–∞–∫—Ü–∏—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç SSTables –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã.

2. **–ß—Ç–µ–Ω–∏–µ**:
   - –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **–º–µ–º—Ç–∞–±–ª–∏—Ü–∞**.
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–∞–º –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **SSTables** (–Ω–∞—á–∏–Ω–∞—è —Å –º–ª–∞–¥—à–∏—Ö —É—Ä–æ–≤–Ω–µ–π).
   - –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–ë–ª—É–º-—Ñ–∏–ª—å—Ç—Ä** –∏ –∏–Ω–¥–µ–∫—Å—ã.

## –î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ LSM-Tree
‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ (append-only).  
‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∏—Å–∫–æ–≤—ã–º–∏ –Ω–æ—Å–∏—Ç–µ–ª—è–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ SSD).  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å—á—ë—Ç –∫–æ–º–ø–∞–∫—Ü–∏–∏.  

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ LSM-Tree
‚ùå –ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑-–∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —É—Ä–æ–≤–Ω–µ–π SSTable.  
‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∫–æ–º–ø–∞–∫—Ü–∏—é (–Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU –∏ –¥–∏—Å–∫).  

## –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LSM-Tree?
- **NoSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**: LevelDB, RocksDB, Cassandra, HBase.
- **–ñ—É—Ä–Ω–∞–ª—ã —Å–æ–±—ã—Ç–∏–π**: Kafka, Apache Pulsar.
- **–§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã**: WiscKey, F2FS.

---
LSM-Tree ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ–º–∞—è –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. üöÄ


## SSTable (Sorted String Table)


## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è LSM-Tree
![alt text](lsm_tree.jpg)