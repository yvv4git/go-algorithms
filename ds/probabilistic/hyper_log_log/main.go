package main

import (
	"fmt"
	"math/rand"
)

func main() {
	/*
		В этом примере мы вычисляем количество уникальных элементов данных в наборе.
		Мы будем использовать HyperLogLog с 16 регистрами (b = 4), что дает нам приблизительное значение для набора данных размером до 65536 уникальных элементов.

		Этот код создает новый HyperLogLog с заданным количеством регистров и использует FNV-1a хэш-функцию для хэширования элементов.
		Метод Add добавляет элемент в HyperLogLog, а метод Count возвращает оценку количества уникальных элементов.
	*/
	hll := NewHyperLogLog(4) // Используем 16 регистров (b = 4)

	// Добавляем случайные элементы в HyperLogLog
	for i := 0; i < 10000; i++ {
		item := make([]byte, 8)
		rand.Read(item)
		hll.Add(item)
	}

	// Получаем оценку количества уникальных элементов
	estimate := hll.Count()
	fmt.Printf("Estimated number of unique elements: %.2f\n", estimate)
}
