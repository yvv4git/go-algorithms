package main

import "fmt"

func validUtf8(data []int) bool {
	/*
		METHOD: Bitwise
		Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¿Ð¾Ð±Ð¸Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð´Ð»Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ñ‚Ð¸Ð¿Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° UTF-8 Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð±Ð°Ð¹Ñ‚Ð¾Ð².
		ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð¸Ð¼ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð±Ð°Ð¹Ñ‚Ñƒ Ð¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼, ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¸ Ð¾Ð½ Ð½Ð°Ñ‡Ð°Ð»Ð¾Ð¼ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽÑ‰Ð¸Ð¼ Ð±Ð°Ð¹Ñ‚Ð¾Ð¼.

		TIME COMPLEXITY:
		O(n), Ð³Ð´Ðµ n â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð² Ð¼Ð°ÑÑÐ¸Ð²Ðµ data. ÐœÑ‹ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ð¼ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð±Ð°Ð¹Ñ‚Ñƒ Ñ€Ð¾Ð²Ð½Ð¾ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·.

		SPACE COMPLEXITY:
		O(1), Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸ (Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ remainingBytes).
	*/
	// ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾ÑÑ‚Ð°Ð²ÑˆÐ¸Ñ…ÑÑ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° UTF-8
	remainingBytes := 0

	// ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð¸Ð¼ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð±Ð°Ð¹Ñ‚Ñƒ Ð² Ð¼Ð°ÑÑÐ¸Ð²Ðµ
	for _, byteValue := range data {
		if remainingBytes == 0 {
			// ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° UTF-8
			if byteValue&0b10000000 == 0 {
				// ÐžÐ´Ð½Ð¾-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
				remainingBytes = 0
			} else if byteValue&0b11100000 == 0b11000000 {
				// Ð”Ð²ÑƒÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
				remainingBytes = 1
			} else if byteValue&0b11110000 == 0b11100000 {
				// Ð¢Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
				remainingBytes = 2
			} else if byteValue&0b11111000 == 0b11110000 {
				// Ð§ÐµÑ‚Ñ‹Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
				remainingBytes = 3
			} else {
				// ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð±Ð°Ð¹Ñ‚
				return false
			}
		} else {
			// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð±Ð°Ð¹Ñ‚ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽÑ‰Ð¸Ð¼ Ð±Ð°Ð¹Ñ‚Ð¾Ð¼
			if byteValue&0b11000000 != 0b10000000 {
				return false
			}
			// Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾ÑÑ‚Ð°Ð²ÑˆÐ¸Ñ…ÑÑ Ð±Ð°Ð¹Ñ‚Ð¾Ð²
			remainingBytes--
		}
	}

	// Ð•ÑÐ»Ð¸ remainingBytes == 0, Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ð²ÑÐµ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹
	return remainingBytes == 0
}

func main() {
	// ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸
	//testCases := []struct {
	//	data []int
	//	desc string
	//}{
	//	{[]int{0b00000000}, "ÐžÐ´Ð½Ð¾-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b11000000, 0b10000000}, "Ð”Ð²ÑƒÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b11100000, 0b10000000, 0b10000000}, "Ð¢Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b11110000, 0b10000000, 0b10000000, 0b10000000}, "Ð§ÐµÑ‚Ñ‹Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b10000000}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð¾Ð´Ð½Ð¾-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b11100000, 0b10000000, 0b00000000}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ñ‚Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//	{[]int{0b11110000, 0b10000000, 0b10000000, 0b11000000}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ñ‡ÐµÑ‚Ñ‹Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	//}

	testCases := []struct {
		data []int
		desc string
	}{
		{[]int{0x00}, "ÐžÐ´Ð½Ð¾-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»: NUL"},
		{[]int{0xC2, 0xA9}, "Ð”Ð²ÑƒÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»: Â©"},
		{[]int{0xE2, 0x82, 0xAC}, "Ð¢Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»: â‚¬"},
		{[]int{0xF0, 0x9F, 0x98, 0x81}, "Ð§ÐµÑ‚Ñ‹Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»: ðŸ˜"},
		{[]int{0x80}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð¾Ð´Ð½Ð¾-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
		{[]int{0xE0, 0x80, 0x80}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ñ‚Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
		{[]int{0xF0, 0x80, 0x80, 0x80}, "ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ñ‡ÐµÑ‚Ñ‹Ñ€ÐµÑ…-Ð±Ð°Ð¹Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»"},
	}

	for _, tc := range testCases {
		result := validUtf8(tc.data)
		fmt.Printf("%s: %v -> %t\n", tc.desc, tc.data, result)
	}
}
